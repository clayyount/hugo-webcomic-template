!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("react"),require("prop-types"),require("react-emotion"),require("netlify-cms-ui-default"),require("immutable"),require("react-immutable-proptypes")):"function"==typeof define&&define.amd?define("netlify-cms-widget-file",["react","prop-types","react-emotion","netlify-cms-ui-default","immutable","react-immutable-proptypes"],t):"object"==typeof exports?exports["netlify-cms-widget-file"]=t(require("react"),require("prop-types"),require("react-emotion"),require("netlify-cms-ui-default"),require("immutable"),require("react-immutable-proptypes")):e["netlify-cms-widget-file"]=t(e.react,e["prop-types"],e["react-emotion"],e["netlify-cms-ui-default"],e.immutable,e["react-immutable-proptypes"])}(window,function(e,t,n,r,o,i){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=24)}([function(t,n){t.exports=e},function(e,n){e.exports=t},function(e,t){e.exports=n},function(e,t){e.exports=r},function(e,t){e.exports=o},function(e,t,n){var r=n(16).Symbol;e.exports=r},function(e,t,n){var r=n(9);e.exports=function(e){return r(2,e)}},function(e,t){e.exports=i},function(e,t,n){var r=n(22),o=n(23);e.exports=function(e,t,n){var i=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var a=(e=e||{}).random||(e.rng||r)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t)for(var u=0;u<16;++u)t[i+u]=a[u];return t||o(a)}},function(e,t,n){var r=n(10),o="Expected a function";e.exports=function(e,t){var n;if("function"!=typeof t)throw new TypeError(o);return e=r(e),function(){return--e>0&&(n=t.apply(this,arguments)),e<=1&&(t=void 0),n}}},function(e,t,n){var r=n(11);e.exports=function(e){var t=r(e),n=t%1;return t==t?n?t-n:t:0}},function(e,t,n){var r=n(12),o=1/0,i=1.7976931348623157e308;e.exports=function(e){return e?(e=r(e))===o||e===-o?(e<0?-1:1)*i:e==e?e:0:0===e?e:0}},function(e,t,n){var r=n(13),o=n(14),i=NaN,a=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,c=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(o(e))return i;if(r(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=r(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(a,"");var n=s.test(e);return n||l.test(e)?c(e.slice(2),n?2:8):u.test(e)?i:+e}},function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},function(e,t,n){var r=n(15),o=n(21),i="[object Symbol]";e.exports=function(e){return"symbol"==typeof e||o(e)&&r(e)==i}},function(e,t,n){var r=n(5),o=n(19),i=n(20),a="[object Null]",u="[object Undefined]",s=r?r.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?u:a:s&&s in Object(e)?o(e):i(e)}},function(e,t,n){var r=n(17),o="object"==typeof self&&self&&self.Object===Object&&self,i=r||o||Function("return this")();e.exports=i},function(e,t,n){(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.exports=n}).call(this,n(18))},function(e,t){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var r=n(5),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,u=r?r.toStringTag:void 0;e.exports=function(e){var t=i.call(e,u),n=e[u];try{e[u]=void 0;var r=!0}catch(e){}var o=a.call(e);return r&&(t?e[u]=n:delete e[u]),o}},function(e,t){var n=Object.prototype.toString;e.exports=function(e){return n.call(e)}},function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},function(e,t){var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var r=new Uint8Array(16);e.exports=function(){return n(r),r}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},function(e,t){for(var n=[],r=0;r<256;++r)n[r]=(r+256).toString(16).substr(1);e.exports=function(e,t){var r=t||0,o=n;return[o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],"-",o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]],o[e[r++]]].join("")}},function(e,t,n){"use strict";n.r(t);var r=n(6),o=n.n(r),i=n(0),a=n.n(i),u=n(1),s=n.n(u),l=n(7),c=n.n(l),f=n(2),p=n.n(f),d=n(4),m=n(8),g=n.n(m),y=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),h=function(e,t){return Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}(["",""],["",""]);var v=function(){function e(){for(var t=this,n=arguments.length,r=Array(n),o=0;o<n;o++)r[o]=arguments[o];return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.tag=function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return"function"==typeof e?t.interimTag.bind(t,e):"string"==typeof e?t.transformEndResult(e):(e=e.map(t.transformString.bind(t)),t.transformEndResult(e.reduce(t.processSubstitutions.bind(t,r))))},r.length>0&&Array.isArray(r[0])&&(r=r[0]),this.transformers=r.map(function(e){return"function"==typeof e?e():e}),this.tag}return y(e,[{key:"interimTag",value:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),o=2;o<n;o++)r[o-2]=arguments[o];return this.tag(h,e.apply(void 0,[t].concat(r)))}},{key:"processSubstitutions",value:function(e,t,n){var r=this.transformSubstitution(e.shift(),t);return"".concat(t,r,n)}},{key:"transformString",value:function(e){return this.transformers.reduce(function(e,t){return t.onString?t.onString(e):e},e)}},{key:"transformSubstitution",value:function(e,t){return this.transformers.reduce(function(e,n){return n.onSubstitution?n.onSubstitution(e,t):e},e)}},{key:"transformEndResult",value:function(e){return this.transformers.reduce(function(e,t){return t.onEndResult?t.onEndResult(e):e},e)}}]),e}(),b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return{onEndResult:function(t){if(""===e)return t.trim();if("start"===(e=e.toLowerCase())||"left"===e)return t.replace(/^\s*/,"");if("end"===e||"right"===e)return t.replace(/\s*$/,"");throw new Error("Side not supported: "+e)}}};var w=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"initial";return{onEndResult:function(t){if("initial"===e){var n=t.match(/^[^\S\n]*(?=\S)/gm),r=n&&Math.min.apply(Math,function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(n.map(function(e){return e.length})));if(r){var o=new RegExp("^.{"+r+"}","gm");return t.replace(o,"")}return t}if("all"===e)return t.replace(/^[^\S\n]+/gm,"");throw new Error("Unknown type: "+e)}}},j=function(e,t){return{onEndResult:function(n){if(null==e||null==t)throw new Error("replaceResultTransformer requires at least 2 arguments.");return n.replace(e,t)}}},x=function(e,t){return{onSubstitution:function(n,r){if(null==e||null==t)throw new Error("replaceSubstitutionTransformer requires at least 2 arguments.");return null==n?n:n.toString().replace(e,t)}}},E={separator:"",conjunction:"",serial:!1},S=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E;return{onSubstitution:function(t,n){if(Array.isArray(t)){var r=t.length,o=e.separator,i=e.conjunction,a=e.serial,u=n.match(/(\n?[^\S\n]+)$/);if(t=u?t.join(o+u[1]):t.join(o+" "),i&&r>1){var s=t.lastIndexOf(o);t=t.slice(0,s)+(a?o:"")+" "+i+t.slice(s+1)}}return t}}},R=function(e){return{onSubstitution:function(t,n){if(null==e||"string"!=typeof e)throw new Error("You need to specify a string character to split by.");return"string"==typeof t&&t.includes(e)&&(t=t.split(e)),t}}},A=function(e){return null!=e&&!Number.isNaN(e)&&"boolean"!=typeof e},C=function(){return{onSubstitution:function(e){return Array.isArray(e)?e.filter(A):A(e)?e:""}}},O=(new v(S({separator:","}),w,b),new v(S({separator:",",conjunction:"and"}),w,b),new v(S({separator:",",conjunction:"or"}),w,b),new v(R("\n"),C,S,w,b),new v(R("\n"),S,w,b,x(/&/g,"&amp;"),x(/</g,"&lt;"),x(/>/g,"&gt;"),x(/"/g,"&quot;"),x(/'/g,"&#x27;"),x(/`/g,"&#x60;")),new v(j(/(?:\n(?:\s*))+/g," "),b)),q=(new v(j(/(?:\n\s*)/g,""),b),new v(S({separator:","}),j(/(?:\s+)/g," "),b),new v(S({separator:",",conjunction:"or"}),j(/(?:\s+)/g," "),b),new v(S({separator:",",conjunction:"and"}),j(/(?:\s+)/g," "),b),new v(S,w,b),new v(S,j(/(?:\s+)/g," "),b),new v(w,b),new v(w("all"),b),n(3));function k(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const M=50,I=p()("div",{target:"e1awjdnj0"})("flex-basis:155px;width:155px;height:100px;margin-right:20px;margin-bottom:20px;"),P=p()("img",{target:"e1awjdnj1"})("width:100%;height:100%;object-fit:cover;border-radius:",q.lengths.borderRadius,";"),_=p()("div",{target:"e1awjdnj2"})("display:flex;flex-wrap:wrap;"),T=p()("div",{target:"e1awjdnj3"})("button:not(:first-child){margin-top:12px;}"),D=p()("a",{target:"e1awjdnj4"})("margin-bottom:20px;font-weight:normal;color:inherit;&:hover,&:active,&:focus{text-decoration:underline;}"),L=p()("ul",{target:"e1awjdnj5"})("list-style-type:none;"),N=p()("button",{target:"e1awjdnj6"})(q.buttons.button,";",q.components.badge,";"),F=p()("button",{target:"e1awjdnj7"})(q.buttons.button,";",q.components.badgeDanger,";");function $(e){return Array.isArray(e)||d.List.isList(e)}const U=o()(e=>console.warn(O`
  Netlify CMS config: ${e.get("name")} field: property "options" has been deprecated for the
  ${e.get("widget")} widget and will be removed in the next major release. Rather than
  \`field.options.media_library\`, apply media library options for this widget under
  \`field.media_library\`.
`));function V({forImage:e}={}){var t,n;return n=t=class extends a.a.Component{constructor(t){super(t),k(this,"handleChange",t=>{const n=this.props,r=n.field,o=n.onOpenMediaLibrary,i=n.value;let a;return t.preventDefault(),r.hasIn(["options","media_library"])?(U(r),a=r.getIn(["options","media_library"],Object(d.Map)())):a=r.get("media_library",Object(d.Map)()),o({controlID:this.controlID,forImage:e,privateUpload:r.get("private"),value:i,allowMultiple:!!a.get("allow_multiple",!0),config:a.get("config")})}),k(this,"handleRemove",e=>(e.preventDefault(),this.props.onClearMediaControl(this.controlID),this.props.onChange(""))),k(this,"renderFileLink",e=>{const t=M;if(!e||e.length<=t)return e;const n=`${e.substring(0,t/2)}…${e.substring(e.length-t/2+1,e.length)}`;return a.a.createElement(D,{href:e,rel:"noopener",target:"_blank"},n)}),k(this,"renderFileLinks",()=>{const e=this.props.value;return $(e)?a.a.createElement(L,null,e.map(e=>a.a.createElement("li",{key:e},this.renderFileLink(e)))):this.renderFileLink(e)}),k(this,"renderImages",()=>{const e=this.props,t=e.getAsset,n=e.value;return $(n)?a.a.createElement(_,null,n.map(e=>a.a.createElement(I,{key:e},a.a.createElement(P,{src:t(e)})))):a.a.createElement(I,null,a.a.createElement(P,{src:t(n)}))}),k(this,"renderSelection",t=>a.a.createElement("div",null,e?this.renderImages():null,a.a.createElement(T,null,e?null:this.renderFileLinks(),a.a.createElement(N,{onClick:this.handleChange},"Choose different ",t),a.a.createElement(F,{onClick:this.handleRemove},"Remove ",t)))),k(this,"renderNoSelection",(e,t)=>a.a.createElement(N,{onClick:this.handleChange},"Choose ",t," ",e)),this.controlID=g()()}shouldComponentUpdate(e){if(this.props.value!==e.value)return!0;const t=e.mediaPaths.get(this.controlID);return!(!t||e.value===t)}componentDidUpdate(){const e=this.props,t=e.mediaPaths,n=e.value,r=e.onRemoveInsertedMedia,o=e.onChange,i=t.get(this.controlID);i&&i!==n?o(i):i&&i===n&&r(this.controlID)}componentWillUnmount(){this.props.onRemoveMediaControl(this.controlID)}render(){const t=this.props,n=t.value,r=t.classNameWrapper,o=e?"image":"file",i=e?"an":"a";return a.a.createElement("div",{className:r},a.a.createElement("span",null,n?this.renderSelection(o):this.renderNoSelection(o,i)))}},k(t,"propTypes",{field:s.a.object.isRequired,getAsset:s.a.func.isRequired,mediaPaths:c.a.map.isRequired,onAddAsset:s.a.func.isRequired,onChange:s.a.func.isRequired,onRemoveInsertedMedia:s.a.func.isRequired,onOpenMediaLibrary:s.a.func.isRequired,onClearMediaControl:s.a.func.isRequired,onRemoveMediaControl:s.a.func.isRequired,classNameWrapper:s.a.string.isRequired,value:s.a.oneOfType([s.a.string,s.a.arrayOf(s.a.string)])}),k(t,"defaultProps",{value:""}),n}const W=p()(({value:e,getAsset:t})=>a.a.createElement("a",{href:t(e),rel:"noopener noreferrer",target:"_blank"},e),{target:"e1sxjo0z0"})("display:block;");function z({values:e,getAsset:t}){return a.a.createElement("div",null,e.map(e=>a.a.createElement(W,{key:e,value:e,getAsset:t})))}function Y({value:e,getAsset:t}){return Array.isArray(e)||d.List.isList(e)?a.a.createElement(z,{values:e,getAsset:t}):a.a.createElement(W,{value:e,getAsset:t})}const B=e=>a.a.createElement(q.WidgetPreviewContainer,null,e.value?a.a.createElement(Y,e):null);B.propTypes={getAsset:s.a.func.isRequired,value:s.a.node};var G=B;n.d(t,"FileControl",function(){return H}),n.d(t,"withFileControl",function(){return V}),n.d(t,"FilePreview",function(){return G});const H=V()}])});
//# sourceMappingURL=netlify-cms-widget-file.js.map