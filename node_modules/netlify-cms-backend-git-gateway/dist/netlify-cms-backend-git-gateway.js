!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("netlify-cms-lib-util"),require("react"),require("netlify-cms-ui-default"),require("lodash/fp/map"),require("lodash/fp/flow"),require("react-emotion"),require("netlify-cms-backend-github"),require("netlify-cms-backend-gitlab"),require("prop-types"),require("lodash/fp/fromPairs"),require("lodash/fromPairs"),require("netlify-cms-backend-bitbucket"),require("lodash/partial"),require("lodash/fp/filter"),require("lodash/unzip"),require("lodash/intersection"),require("lodash/pick"),require("lodash/get"),require("lodash/flow"),require("immutable")):"function"==typeof define&&define.amd?define("netlify-cms-backend-git-gateway",["netlify-cms-lib-util","react","netlify-cms-ui-default","lodash/fp/map","lodash/fp/flow","react-emotion","netlify-cms-backend-github","netlify-cms-backend-gitlab","prop-types","lodash/fp/fromPairs","lodash/fromPairs","netlify-cms-backend-bitbucket","lodash/partial","lodash/fp/filter","lodash/unzip","lodash/intersection","lodash/pick","lodash/get","lodash/flow","immutable"],t):"object"==typeof exports?exports["netlify-cms-backend-git-gateway"]=t(require("netlify-cms-lib-util"),require("react"),require("netlify-cms-ui-default"),require("lodash/fp/map"),require("lodash/fp/flow"),require("react-emotion"),require("netlify-cms-backend-github"),require("netlify-cms-backend-gitlab"),require("prop-types"),require("lodash/fp/fromPairs"),require("lodash/fromPairs"),require("netlify-cms-backend-bitbucket"),require("lodash/partial"),require("lodash/fp/filter"),require("lodash/unzip"),require("lodash/intersection"),require("lodash/pick"),require("lodash/get"),require("lodash/flow"),require("immutable")):e["netlify-cms-backend-git-gateway"]=t(e["netlify-cms-lib-util"],e.react,e["netlify-cms-ui-default"],e["lodash/fp/map"],e["lodash/fp/flow"],e["react-emotion"],e["netlify-cms-backend-github"],e["netlify-cms-backend-gitlab"],e["prop-types"],e["lodash/fp/fromPairs"],e["lodash/fromPairs"],e["netlify-cms-backend-bitbucket"],e["lodash/partial"],e["lodash/fp/filter"],e["lodash/unzip"],e["lodash/intersection"],e["lodash/pick"],e["lodash/get"],e["lodash/flow"],e.immutable)}(window,function(e,t,r,n,i,o,a,s,u,c,l,h,f,p,d,g,y,m,b,v){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=36)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){e.exports=n},function(e,t){e.exports=i},function(e,t){e.exports=o},function(e,t){e.exports=a},function(e,t){e.exports=s},function(e,t){e.exports=u},function(e,t){e.exports=c},function(e,t){e.exports=l},function(e,t){e.exports=h},function(e,t){e.exports=f},function(e,t){e.exports=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONHTTPError=t.TextHTTPError=t.HTTPError=void 0;var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(26);function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function u(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function c(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}var l=t.HTTPError=function(e){function t(e){a(this,t);var r=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e.statusText));return r.name=r.constructor.name,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=new Error(e.statusText).stack,r.status=e.status,r}return u(t,c(Error)),t}(),h=t.TextHTTPError=function(e){function t(e,r){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.data=r,n}return u(t,l),t}(),f=t.JSONHTTPError=function(e){function t(e,r){a(this,t);var n=s(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.json=r,n}return u(t,l),t}(),p=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments[1];a(this,e),this.apiURL=t,this.apiURL.match(/\/[^\/]?/)&&(this._sameOrigin=!0),this.defaultHeaders=r&&r.defaultHeaders||{}}return i(e,[{key:"headers",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return n({},this.defaultHeaders,{"Content-Type":"application/json"},e)}},{key:"parseJsonResponse",value:function(e){return e.json().then(function(t){if(!e.ok)return Promise.reject(new f(e,t));var r=(0,o.getPagination)(e);return r?{pagination:r,items:t}:t})}},{key:"request",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=this.headers(r.headers||{});return this._sameOrigin&&(r.credentials=r.credentials||"same-origin"),fetch(this.apiURL+e,n({},r,{headers:i})).then(function(e){var r=e.headers.get("Content-Type");return r&&r.match(/json/)?t.parseJsonResponse(e):e.ok?e.text().then(function(e){}):e.text().then(function(t){return Promise.reject(new h(e,t))})})}}]),e}();t.default=p},function(e,t){var r,n,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(r===setTimeout)return setTimeout(e,0);if((r===o||!r)&&setTimeout)return r=setTimeout,setTimeout(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}!function(){try{r="function"==typeof setTimeout?setTimeout:o}catch(e){r=o}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var u,c=[],l=!1,h=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):h=-1,c.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++h<t;)u&&u[h].run();h=-1,t=c.length}u=null,l=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];c.push(new d(e,t)),1!==c.length||l||s(p)},d.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){e.exports=d},function(e,t){e.exports=g},function(e,t){e.exports=y},function(e,t){e.exports=m},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),i=r(14),o=s(i),a=s(r(27));function s(e){return e&&e.__esModule?e:{default:e}}var u=/^http:\/\//,c="/.netlify/identity",l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.APIUrl,n=void 0===r?c:r,i=t.audience,a=void 0===i?"":i,s=t.setCookie,l=void 0!==s&&s;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),n.match(u)&&console.warn("Warning:\n\nDO NOT USE HTTP IN PRODUCTION FOR GOTRUE EVER!\nGoTrue REQUIRES HTTPS to work securely."),a&&(this.audience=a),this.setCookie=l,this.api=new o.default(n)}return n(e,[{key:"_request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.headers=t.headers||{};var r=t.audience||this.audience;return r&&(t.headers["X-JWT-AUD"]=r),this.api.request(e,t).catch(function(e){return e instanceof i.JSONHTTPError&&e.json&&(e.json.msg?e.message=e.json.msg:e.json.error&&(e.message=e.json.error+": "+e.json.error_description)),Promise.reject(e)})}},{key:"settings",value:function(){return this._request("/settings")}},{key:"signup",value:function(e,t,r){return this._request("/signup",{method:"POST",body:JSON.stringify({email:e,password:t,data:r})})}},{key:"login",value:function(e,t,r){var n=this;return this._setRememberHeaders(r),this._request("/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=password&username="+encodeURIComponent(e)+"&password="+encodeURIComponent(t)}).then(function(e){return a.default.removeSavedSession(),n.createUser(e,r)})}},{key:"loginExternalUrl",value:function(e){return this.api.apiURL+"/authorize?provider="+e}},{key:"confirm",value:function(e,t){return this._setRememberHeaders(t),this.verify("signup",e,t)}},{key:"requestPasswordRecovery",value:function(e){return this._request("/recover",{method:"POST",body:JSON.stringify({email:e})})}},{key:"recover",value:function(e,t){return this._setRememberHeaders(t),this.verify("recovery",e,t)}},{key:"acceptInvite",value:function(e,t,r){var n=this;return this._setRememberHeaders(r),this._request("/verify",{method:"POST",body:JSON.stringify({token:e,password:t,type:"signup"})}).then(function(e){return n.createUser(e,r)})}},{key:"acceptInviteExternalUrl",value:function(e,t){return this.api.apiURL+"/authorize?provider="+e+"&invite_token="+t}},{key:"createUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._setRememberHeaders(t),new a.default(this.api,e,this.audience).getUserData().then(function(e){return t&&e._saveSession(),e})}},{key:"currentUser",value:function(){var e=a.default.recoverSession(this.api);return e&&this._setRememberHeaders(e._fromStorage),e}},{key:"verify",value:function(e,t,r){var n=this;return this._setRememberHeaders(r),this._request("/verify",{method:"POST",body:JSON.stringify({token:t,type:e})}).then(function(e){return n.createUser(e,r)})}},{key:"_setRememberHeaders",value:function(e){this.setCookie&&(this.api.defaultHeaders=this.api.defaultHeaders||{},this.api.defaultHeaders["X-Use-Cookie"]=e?"1":"session")}}]),e}();t.default=l,"undefined"!=typeof window&&(window.GoTrue=l)},function(e,t,r){"use strict";var n=r(29);function i(e){this.message=e}i.prototype=new Error,i.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new i("Invalid token specified");var r=!0===(t=t||{}).header?0:1;try{return JSON.parse(n(e.split(".")[r]))}catch(e){throw new i("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=i},function(e,t,r){(function(e){t.parse=t.decode=function(e){var t={},r=t,i=null,o=/^\[([^\]]*)\]$|^([^=]+)(=(.*))?$/i;return e.split(/[\r\n]+/g).forEach(function(e,n,s){if(e&&!e.match(/^\s*[;#]/)){var u=e.match(o);if(u){if(void 0!==u[1])return i=a(u[1]),void(r=t[i]=t[i]||{});var c=a(u[2]),l=!u[3]||a(u[4]);switch(l){case"true":case"false":case"null":l=JSON.parse(l)}c.length>2&&"[]"===c.slice(-2)&&(c=c.substring(0,c.length-2),r[c]?Array.isArray(r[c])||(r[c]=[r[c]]):r[c]=[]),Array.isArray(r[c])?r[c].push(l):r[c]=l}}}),Object.keys(t).filter(function(e,r,i){if(!t[e]||"object"!=typeof t[e]||Array.isArray(t[e]))return!1;var o=n(e),a=t,s=o.pop(),u=s.replace(/\\\./g,".");return o.forEach(function(e,t,r){a[e]&&"object"==typeof a[e]||(a[e]={}),a=a[e]}),(a!==t||u!==s)&&(a[u]=t[e],!0)}).forEach(function(e,r,n){delete t[e]}),t},t.stringify=t.encode=function e(t,i){var a=[];var s="";"string"==typeof i?i={section:i,whitespace:!1}:(i=i||{}).whitespace=!0===i.whitespace;var u=i.whitespace?" = ":"=";Object.keys(t).forEach(function(e,n,i){var c=t[e];c&&Array.isArray(c)?c.forEach(function(t){s+=o(e+"[]")+u+o(t)+"\n"}):c&&"object"==typeof c?a.push(e):s+=o(e)+u+o(c)+r});i.section&&s.length&&(s="["+o(i.section)+"]"+r+s);a.forEach(function(o,a,u){var c=n(o).join("\\."),l=(i.section?i.section+".":"")+c,h=e(t[o],{section:l,whitespace:i.whitespace});s.length&&h.length&&(s+=r),s+=h});return s},t.safe=o,t.unsafe=a;var r=void 0!==e&&"win32"===e.platform?"\r\n":"\n";function n(e){return e.replace(/\1/g,"LITERAL\\1LITERAL").replace(/\\\./g,"").split(/\./).map(function(e){return e.replace(/\1/g,"\\.").replace(/\2LITERAL\\1LITERAL\2/g,"")})}function i(e){return'"'===e.charAt(0)&&'"'===e.slice(-1)||"'"===e.charAt(0)&&"'"===e.slice(-1)}function o(e){return"string"!=typeof e||e.match(/[=\r\n]/)||e.match(/^\[/)||e.length>1&&i(e)||e!==e.trim()?JSON.stringify(e):e.replace(/;/g,"\\;").replace(/#/g,"\\#")}function a(e,t){if(!i(e=(e||"").trim())){for(var r=!1,n="",o=0,a=e.length;o<a;o++){var s=e.charAt(o);if(r)-1!=="\\;#".indexOf(s)?n+=s:n+="\\"+s,r=!1;else{if(-1!==";#".indexOf(s))break;"\\"===s?r=!0:n+=s}}return r&&(n+="\\"),n.trim()}"'"===e.charAt(0)&&(e=e.substr(1,e.length-2));try{e=JSON.parse(e)}catch(e){}return e}}).call(this,r(15))},function(e,t,r){"use strict";var n=r(31),i="<<anonymous>>",o={listOf:function(e){return c(e,"List",n.List.isList)},mapOf:function(e,t){return l(e,t,"Map",n.Map.isMap)},orderedMapOf:function(e,t){return l(e,t,"OrderedMap",n.OrderedMap.isOrderedMap)},setOf:function(e){return c(e,"Set",n.Set.isSet)},orderedSetOf:function(e){return c(e,"OrderedSet",n.OrderedSet.isOrderedSet)},stackOf:function(e){return c(e,"Stack",n.Stack.isStack)},iterableOf:function(e){return c(e,"Iterable",n.Iterable.isIterable)},recordOf:function(e){return s(function(t,r,i,o,s){for(var u=arguments.length,c=Array(u>5?u-5:0),l=5;l<u;l++)c[l-5]=arguments[l];var h=t[r];if(!(h instanceof n.Record)){var f=a(h),p=o;return new Error("Invalid "+p+" `"+s+"` of type `"+f+"` supplied to `"+i+"`, expected an Immutable.js Record.")}for(var d in e){var g=e[d];if(g){var y=h.toObject(),m=g.apply(void 0,[y,d,i,o,s+"."+d].concat(c));if(m)return m}}})},shape:f,contains:f,mapContains:function(e){return h(e,"Map",n.Map.isMap)},list:u("List",n.List.isList),map:u("Map",n.Map.isMap),orderedMap:u("OrderedMap",n.OrderedMap.isOrderedMap),set:u("Set",n.Set.isSet),orderedSet:u("OrderedSet",n.OrderedSet.isOrderedSet),stack:u("Stack",n.Stack.isStack),seq:u("Seq",n.Seq.isSeq),record:u("Record",function(e){return e instanceof n.Record}),iterable:u("Iterable",n.Iterable.isIterable)};function a(e){var t=typeof e;return Array.isArray(e)?"array":e instanceof RegExp?"object":e instanceof n.Iterable?"Immutable."+e.toSource().split(" ")[0]:t}function s(e){function t(t,r,n,o,a,s){for(var u=arguments.length,c=Array(u>6?u-6:0),l=6;l<u;l++)c[l-6]=arguments[l];return s=s||n,o=o||i,null!=r[n]?e.apply(void 0,[r,n,o,a,s].concat(c)):t?new Error("Required "+a+" `"+s+"` was not specified in `"+o+"`."):void 0}var r=t.bind(null,!1);return r.isRequired=t.bind(null,!0),r}function u(e,t){return s(function(r,n,i,o,s){var u=r[n];if(!t(u)){var c=a(u);return new Error("Invalid "+o+" `"+s+"` of type `"+c+"` supplied to `"+i+"`, expected `"+e+"`.")}return null})}function c(e,t,r){return s(function(n,i,o,s,u){for(var c=arguments.length,l=Array(c>5?c-5:0),h=5;h<c;h++)l[h-5]=arguments[h];var f=n[i];if(!r(f)){var p=s,d=a(f);return new Error("Invalid "+p+" `"+u+"` of type `"+d+"` supplied to `"+o+"`, expected an Immutable.js "+t+".")}if("function"!=typeof e)return new Error("Invalid typeChecker supplied to `"+o+"` for propType `"+u+"`, expected a function.");for(var g=f.toArray(),y=0,m=g.length;y<m;y++){var b=e.apply(void 0,[g,y,o,s,u+"["+y+"]"].concat(l));if(b instanceof Error)return b}})}function l(e,t,r,n){return s(function(){for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return c(e,r,n).apply(void 0,o)||t&&function(e){return s(function(t,r,n,i,o){for(var a=arguments.length,s=Array(a>5?a-5:0),u=5;u<a;u++)s[u-5]=arguments[u];var c=t[r];if("function"!=typeof e)return new Error("Invalid keysTypeChecker (optional second argument) supplied to `"+n+"` for propType `"+o+"`, expected a function.");for(var l=c.keySeq().toArray(),h=0,f=l.length;h<f;h++){var p=e.apply(void 0,[l,h,n,i,o+" -> key("+l[h]+")"].concat(s));if(p instanceof Error)return p}})}(t).apply(void 0,o)})}function h(e){var t=void 0===arguments[1]?"Iterable":arguments[1],r=void 0===arguments[2]?n.Iterable.isIterable:arguments[2];return s(function(n,i,o,s,u){for(var c=arguments.length,l=Array(c>5?c-5:0),h=5;h<c;h++)l[h-5]=arguments[h];var f=n[i];if(!r(f)){var p=a(f);return new Error("Invalid "+s+" `"+u+"` of type `"+p+"` supplied to `"+o+"`, expected an Immutable.js "+t+".")}var d=f.toObject();for(var g in e){var y=e[g];if(y){var m=y.apply(void 0,[d,g,o,s,u+"."+g].concat(l));if(m)return m}}})}function f(e){return h(e)}e.exports=o},function(e,t){e.exports=b},function(e,t,r){e.exports=d,d.Minimatch=g;var n={sep:"/"};try{n=r(32)}catch(e){}var i=d.GLOBSTAR=g.GLOBSTAR={},o=r(33),a={"!":{open:"(?:(?!(?:",close:"))[^/]*?)"},"?":{open:"(?:",close:")?"},"+":{open:"(?:",close:")+"},"*":{open:"(?:",close:")*"},"@":{open:"(?:",close:")"}},s="[^/]",u=s+"*?",c="(?:(?!(?:\\/|^)(?:\\.{1,2})($|\\/)).)*?",l="(?:(?!(?:\\/|^)\\.).)*?",h=function(e){return e.split("").reduce(function(e,t){return e[t]=!0,e},{})}("().*{}+?[]^$\\!");var f=/\/+/;function p(e,t){e=e||{},t=t||{};var r={};return Object.keys(t).forEach(function(e){r[e]=t[e]}),Object.keys(e).forEach(function(t){r[t]=e[t]}),r}function d(e,t,r){if("string"!=typeof t)throw new TypeError("glob pattern string required");return r||(r={}),!(!r.nocomment&&"#"===t.charAt(0))&&(""===t.trim()?""===e:new g(t,r).match(e))}function g(e,t){if(!(this instanceof g))return new g(e,t);if("string"!=typeof e)throw new TypeError("glob pattern string required");t||(t={}),e=e.trim(),"/"!==n.sep&&(e=e.split(n.sep).join("/")),this.options=t,this.set=[],this.pattern=e,this.regexp=null,this.negate=!1,this.comment=!1,this.empty=!1,this.make()}function y(e,t){if(t||(t=this instanceof g?this.options:{}),void 0===(e=void 0===e?this.pattern:e))throw new TypeError("undefined pattern");return t.nobrace||!e.match(/\{.*\}/)?[e]:o(e)}d.filter=function(e,t){return t=t||{},function(r,n,i){return d(r,e,t)}},d.defaults=function(e){if(!e||!Object.keys(e).length)return d;var t=d,r=function(r,n,i){return t.minimatch(r,n,p(e,i))};return r.Minimatch=function(r,n){return new t.Minimatch(r,p(e,n))},r},g.defaults=function(e){return e&&Object.keys(e).length?d.defaults(e).Minimatch:g},g.prototype.debug=function(){},g.prototype.make=function(){if(this._made)return;var e=this.pattern,t=this.options;if(!t.nocomment&&"#"===e.charAt(0))return void(this.comment=!0);if(!e)return void(this.empty=!0);this.parseNegate();var r=this.globSet=this.braceExpand();t.debug&&(this.debug=console.error);this.debug(this.pattern,r),r=this.globParts=r.map(function(e){return e.split(f)}),this.debug(this.pattern,r),r=r.map(function(e,t,r){return e.map(this.parse,this)},this),this.debug(this.pattern,r),r=r.filter(function(e){return-1===e.indexOf(!1)}),this.debug(this.pattern,r),this.set=r},g.prototype.parseNegate=function(){var e=this.pattern,t=!1,r=0;if(this.options.nonegate)return;for(var n=0,i=e.length;n<i&&"!"===e.charAt(n);n++)t=!t,r++;r&&(this.pattern=e.substr(r));this.negate=t},d.braceExpand=function(e,t){return y(e,t)},g.prototype.braceExpand=y,g.prototype.parse=function(e,t){if(e.length>65536)throw new TypeError("pattern is too long");var r=this.options;if(!r.noglobstar&&"**"===e)return i;if(""===e)return"";var n,o="",c=!!r.nocase,l=!1,f=[],p=[],d=!1,g=-1,y=-1,b="."===e.charAt(0)?"":r.dot?"(?!(?:^|\\/)\\.{1,2}(?:$|\\/))":"(?!\\.)",v=this;function w(){if(n){switch(n){case"*":o+=u,c=!0;break;case"?":o+=s,c=!0;break;default:o+="\\"+n}v.debug("clearStateChar %j %j",n,o),n=!1}}for(var k,O=0,j=e.length;O<j&&(k=e.charAt(O));O++)if(this.debug("%s\t%s %s %j",e,O,o,k),l&&h[k])o+="\\"+k,l=!1;else switch(k){case"/":return!1;case"\\":w(),l=!0;continue;case"?":case"*":case"+":case"@":case"!":if(this.debug("%s\t%s %s %j <-- stateChar",e,O,o,k),d){this.debug("  in class"),"!"===k&&O===y+1&&(k="^"),o+=k;continue}v.debug("call clearStateChar %j",n),w(),n=k,r.noext&&w();continue;case"(":if(d){o+="(";continue}if(!n){o+="\\(";continue}f.push({type:n,start:O-1,reStart:o.length,open:a[n].open,close:a[n].close}),o+="!"===n?"(?:(?!(?:":"(?:",this.debug("plType %j %j",n,o),n=!1;continue;case")":if(d||!f.length){o+="\\)";continue}w(),c=!0;var P=f.pop();o+=P.close,"!"===P.type&&p.push(P),P.reEnd=o.length;continue;case"|":if(d||!f.length||l){o+="\\|",l=!1;continue}w(),o+="|";continue;case"[":if(w(),d){o+="\\"+k;continue}d=!0,y=O,g=o.length,o+=k;continue;case"]":if(O===y+1||!d){o+="\\"+k,l=!1;continue}if(d){var S=e.substring(y+1,O);try{RegExp("["+S+"]")}catch(e){var _=this.parse(S,m);o=o.substr(0,g)+"\\["+_[0]+"\\]",c=c||_[1],d=!1;continue}}c=!0,d=!1,o+=k;continue;default:w(),l?l=!1:!h[k]||"^"===k&&d||(o+="\\"),o+=k}d&&(S=e.substr(y+1),_=this.parse(S,m),o=o.substr(0,g)+"\\["+_[0],c=c||_[1]);for(P=f.pop();P;P=f.pop()){var E=o.slice(P.reStart+P.open.length);this.debug("setting tail",o,P),E=E.replace(/((?:\\{2}){0,64})(\\?)\|/g,function(e,t,r){return r||(r="\\"),t+t+r+"|"}),this.debug("tail=%j\n   %s",E,E,P,o);var x="*"===P.type?u:"?"===P.type?s:"\\"+P.type;c=!0,o=o.slice(0,P.reStart)+x+"\\("+E}w(),l&&(o+="\\\\");var T=!1;switch(o.charAt(0)){case".":case"[":case"(":T=!0}for(var I=p.length-1;I>-1;I--){var A=p[I],R=o.slice(0,A.reStart),q=o.slice(A.reStart,A.reEnd-8),U=o.slice(A.reEnd-8,A.reEnd),L=o.slice(A.reEnd);U+=L;var C=R.split("(").length-1,M=L;for(O=0;O<C;O++)M=M.replace(/\)[+*?]?/,"");var $="";""===(L=M)&&t!==m&&($="$");var z=R+q+L+$+U;o=z}""!==o&&c&&(o="(?=.)"+o);T&&(o=b+o);if(t===m)return[o,c];if(!c)return function(e){return e.replace(/\\(.)/g,"$1")}(e);var G=r.nocase?"i":"";try{var D=new RegExp("^"+o+"$",G)}catch(e){return new RegExp("$.")}return D._glob=e,D._src=o,D};var m={};d.makeRe=function(e,t){return new g(e,t||{}).makeRe()},g.prototype.makeRe=function(){if(this.regexp||!1===this.regexp)return this.regexp;var e=this.set;if(!e.length)return this.regexp=!1,this.regexp;var t=this.options,r=t.noglobstar?u:t.dot?c:l,n=t.nocase?"i":"",o=e.map(function(e){return e.map(function(e){return e===i?r:"string"==typeof e?function(e){return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")}(e):e._src}).join("\\/")}).join("|");o="^(?:"+o+")$",this.negate&&(o="^(?!"+o+").*$");try{this.regexp=new RegExp(o,n)}catch(e){this.regexp=!1}return this.regexp},d.match=function(e,t,r){var n=new g(t,r=r||{});return e=e.filter(function(e){return n.match(e)}),n.options.nonull&&!e.length&&e.push(t),e},g.prototype.match=function(e,t){if(this.debug("match",e,this.pattern),this.comment)return!1;if(this.empty)return""===e;if("/"===e&&t)return!0;var r=this.options;"/"!==n.sep&&(e=e.split(n.sep).join("/"));e=e.split(f),this.debug(this.pattern,"split",e);var i,o,a=this.set;for(this.debug(this.pattern,"set",a),o=e.length-1;o>=0&&!(i=e[o]);o--);for(o=0;o<a.length;o++){var s=a[o],u=e;r.matchBase&&1===s.length&&(u=[i]);var c=this.matchOne(u,s,t);if(c)return!!r.flipNegate||!this.negate}return!r.flipNegate&&this.negate},g.prototype.matchOne=function(e,t,r){var n=this.options;this.debug("matchOne",{this:this,file:e,pattern:t}),this.debug("matchOne",e.length,t.length);for(var o=0,a=0,s=e.length,u=t.length;o<s&&a<u;o++,a++){this.debug("matchOne loop");var c,l=t[a],h=e[o];if(this.debug(t,l,h),!1===l)return!1;if(l===i){this.debug("GLOBSTAR",[t,l,h]);var f=o,p=a+1;if(p===u){for(this.debug("** at the end");o<s;o++)if("."===e[o]||".."===e[o]||!n.dot&&"."===e[o].charAt(0))return!1;return!0}for(;f<s;){var d=e[f];if(this.debug("\nglobstar while",e,f,t,p,d),this.matchOne(e.slice(f),t.slice(p),r))return this.debug("globstar found match!",f,s,d),!0;if("."===d||".."===d||!n.dot&&"."===d.charAt(0)){this.debug("dot detected!",e,f,t,p);break}this.debug("globstar swallow a segment, and continue"),f++}return!(!r||(this.debug("\n>>> no match, partial?",e,f,t,p),f!==s))}if("string"==typeof l?(c=n.nocase?h.toLowerCase()===l.toLowerCase():h===l,this.debug("string match",l,h,c)):(c=h.match(l),this.debug("pattern match",l,h,c)),!c)return!1}if(o===s&&a===u)return!0;if(o===s)return r;if(a===u)return o===s-1&&""===e[o];throw new Error("wtf?")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.getPagination=function(e){var t=e.headers.get("Link"),r={};if(null==t)return null;t=t.split(",");for(var i=e.headers.get("X-Total-Count"),o=0,a=t.length;o<a;o++){var s=t[o].replace(/(^\s*|\s*$)/,""),u=s.split(";"),c=n(u,2),l=c[0],h=c[1],f=l.match(/page=(\d+)/),p=f&&parseInt(f[1],10);h.match(/last/)?r.last=p:h.match(/next/)?r.next=p:h.match(/prev/)?r.prev=p:h.match(/first/)&&(r.first=p)}return r.last=Math.max(r.last||0,r.prev&&r.prev+1||0),r.current=r.next?r.next-1:r.last||1,r.total=i?parseInt(i,10):null,r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),o=r(14),a=u(o),s=u(r(28));function u(e){return e&&e.__esModule?e:{default:e}}var c={},l=null,h={api:1,token:1,audience:1,url:1},f={api:1},p=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.api=t,this.url=t.apiURL,this.audience=n,this._processTokenResponse(r),l=this}return i(e,[{key:"update",value:function(e){var t=this;return this._request("/user",{method:"PUT",body:JSON.stringify(e)}).then(function(e){return t._saveUserData(e)._refreshSavedSession()})}},{key:"jwt",value:function(e){var t=this.tokenDetails(),r=t.expires_at,n=t.refresh_token,i=t.access_token;return e||r-6e4<Date.now()?this._refreshToken(n):Promise.resolve(i)}},{key:"logout",value:function(){return this._request("/logout",{method:"POST"}).then(this.clearSession.bind(this)).catch(this.clearSession.bind(this))}},{key:"_refreshToken",value:function(e){var t=this;return c[e]?c[e]:c[e]=this.api.request("/token",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:"grant_type=refresh_token&refresh_token="+e}).then(function(r){return delete c[e],t._processTokenResponse(r),t._refreshSavedSession(),t.token.access_token}).catch(function(r){return delete c[e],t.clearSession(),Promise.reject(r)})}},{key:"_request",value:function(e){var t=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};r.headers=r.headers||{};var i=r.audience||this.audience;return i&&(r.headers["X-JWT-AUD"]=i),this.jwt().then(function(i){return t.api.request(e,n({headers:Object.assign(r.headers,{Authorization:"Bearer "+i})},r)).catch(function(e){return e instanceof o.JSONHTTPError&&e.json&&(e.json.msg?e.message=e.json.msg:e.json.error&&(e.message=e.json.error+": "+e.json.error_description)),Promise.reject(e)})})}},{key:"getUserData",value:function(){return this._request("/user").then(this._saveUserData.bind(this)).then(this._refreshSavedSession.bind(this))}},{key:"_saveUserData",value:function(t,r){for(var n in t)n in e.prototype||n in h||(this[n]=t[n]);return r&&(this._fromStorage=!0),this}},{key:"_processTokenResponse",value:function(e){this.token=e;var t=void 0;try{t=JSON.parse(function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}var r=window.atob(t);try{return decodeURIComponent(escape(r))}catch(e){return r}}(e.access_token.split(".")[1])),this.token.expires_at=1e3*t.exp}catch(t){console.error(new Error("Gotrue-js: Failed to parse tokenResponse claims: "+JSON.stringify(e)))}}},{key:"_refreshSavedSession",value:function(){return localStorage.getItem("gotrue.user")&&this._saveSession(),this}},{key:"_saveSession",value:function(){return localStorage.setItem("gotrue.user",JSON.stringify(this._details)),this}},{key:"tokenDetails",value:function(){return this.token}},{key:"clearSession",value:function(){e.removeSavedSession(),this.token=null,l=null}},{key:"admin",get:function(){return new s.default(this)}},{key:"_details",get:function(){var t={};for(var r in this)r in e.prototype||r in f||(t[r]=this[r]);return t}}],[{key:"removeSavedSession",value:function(){localStorage.removeItem("gotrue.user")}},{key:"recoverSession",value:function(t){if(l)return l;var r=localStorage.getItem("gotrue.user");if(r)try{var n=JSON.parse(r),i=n.url,o=n.token,s=n.audience;return i&&o?new e(t||new a.default(i,{}),o,s)._saveUserData(n,!0):null}catch(e){return console.error(new Error("Gotrue-js: Error recovering session: "+e)),null}return null}}]),e}();t.default=p},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.user=t}return n(e,[{key:"listUsers",value:function(e){return this.user._request("/admin/users",{method:"GET",audience:e})}},{key:"getUser",value:function(e){return this.user._request("/admin/users/"+e.id)}},{key:"updateUser",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.user._request("/admin/users/"+e.id,{method:"PUT",body:JSON.stringify(t)})}},{key:"createUser",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return r.email=e,r.password=t,this.user._request("/admin/users",{method:"POST",body:JSON.stringify(r)})}},{key:"deleteUser",value:function(e){return this.user._request("/admin/users/"+e.id,{method:"DELETE"})}}]),e}();t.default=i},function(e,t,r){var n=r(30);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return function(e){return decodeURIComponent(n(e).replace(/(.)/g,function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}(t)}catch(e){return n(t)}}},function(e,t){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function n(e){this.message=e}n.prototype=new Error,n.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||function(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new n("'atob' failed: The string to be decoded is not correctly encoded.");for(var i,o,a=0,s=0,u="";o=t.charAt(s++);~o&&(i=a%4?64*i+o:o,a++%4)?u+=String.fromCharCode(255&i>>(-2*a&6)):0)o=r.indexOf(o);return u}},function(e,t){e.exports=v},function(e,t,r){(function(e){function r(e,t){for(var r=0,n=e.length-1;n>=0;n--){var i=e[n];"."===i?e.splice(n,1):".."===i?(e.splice(n,1),r++):r&&(e.splice(n,1),r--)}if(t)for(;r--;r)e.unshift("..");return e}var n=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,i=function(e){return n.exec(e).slice(1)};function o(e,t){if(e.filter)return e.filter(t);for(var r=[],n=0;n<e.length;n++)t(e[n],n,e)&&r.push(e[n]);return r}t.resolve=function(){for(var t="",n=!1,i=arguments.length-1;i>=-1&&!n;i--){var a=i>=0?arguments[i]:e.cwd();if("string"!=typeof a)throw new TypeError("Arguments to path.resolve must be strings");a&&(t=a+"/"+t,n="/"===a.charAt(0))}return t=r(o(t.split("/"),function(e){return!!e}),!n).join("/"),(n?"/":"")+t||"."},t.normalize=function(e){var n=t.isAbsolute(e),i="/"===a(e,-1);return(e=r(o(e.split("/"),function(e){return!!e}),!n).join("/"))||n||(e="."),e&&i&&(e+="/"),(n?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(o(e,function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e}).join("/"))},t.relative=function(e,r){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var r=e.length-1;r>=0&&""===e[r];r--);return t>r?[]:e.slice(t,r-t+1)}e=t.resolve(e).substr(1),r=t.resolve(r).substr(1);for(var i=n(e.split("/")),o=n(r.split("/")),a=Math.min(i.length,o.length),s=a,u=0;u<a;u++)if(i[u]!==o[u]){s=u;break}var c=[];for(u=s;u<i.length;u++)c.push("..");return(c=c.concat(o.slice(s))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){var t=i(e),r=t[0],n=t[1];return r||n?(n&&(n=n.substr(0,n.length-1)),r+n):"."},t.basename=function(e,t){var r=i(e)[2];return t&&r.substr(-1*t.length)===t&&(r=r.substr(0,r.length-t.length)),r},t.extname=function(e){return i(e)[3]};var a="b"==="ab".substr(-1)?function(e,t,r){return e.substr(t,r)}:function(e,t,r){return t<0&&(t=e.length+t),e.substr(t,r)}}).call(this,r(15))},function(e,t,r){var n=r(34),i=r(35);e.exports=function(e){if(!e)return[];"{}"===e.substr(0,2)&&(e="\\{\\}"+e.substr(2));return function e(t,r){var o=[];var a=i("{","}",t);if(!a||/\$$/.test(a.pre))return[t];var u=/^-?\d+\.\.-?\d+(?:\.\.-?\d+)?$/.test(a.body);var c=/^[a-zA-Z]\.\.[a-zA-Z](?:\.\.-?\d+)?$/.test(a.body);var h=u||c;var y=a.body.indexOf(",")>=0;if(!h&&!y)return a.post.match(/,.*\}/)?(t=a.pre+"{"+a.body+s+a.post,e(t)):[t];var m;if(h)m=a.body.split(/\.\./);else if(1===(m=function e(t){if(!t)return[""];var r=[];var n=i("{","}",t);if(!n)return t.split(",");var o=n.pre;var a=n.body;var s=n.post;var u=o.split(",");u[u.length-1]+="{"+a+"}";var c=e(s);s.length&&(u[u.length-1]+=c.shift(),u.push.apply(u,c));r.push.apply(r,u);return r}(a.body)).length&&1===(m=e(m[0],!1).map(f)).length){var b=a.post.length?e(a.post,!1):[""];return b.map(function(e){return a.pre+m[0]+e})}var v=a.pre;var b=a.post.length?e(a.post,!1):[""];var w;if(h){var k=l(m[0]),O=l(m[1]),j=Math.max(m[0].length,m[1].length),P=3==m.length?Math.abs(l(m[2])):1,S=d,_=O<k;_&&(P*=-1,S=g);var E=m.some(p);w=[];for(var x=k;S(x,O);x+=P){var T;if(c)"\\"===(T=String.fromCharCode(x))&&(T="");else if(T=String(x),E){var I=j-T.length;if(I>0){var A=new Array(I+1).join("0");T=x<0?"-"+A+T.slice(1):A+T}}w.push(T)}}else w=n(m,function(t){return e(t,!1)});for(var R=0;R<w.length;R++)for(var q=0;q<b.length;q++){var U=v+w[R]+b[q];(!r||h||U)&&o.push(U)}return o}(function(e){return e.split("\\\\").join(o).split("\\{").join(a).split("\\}").join(s).split("\\,").join(u).split("\\.").join(c)}(e),!0).map(h)};var o="\0SLASH"+Math.random()+"\0",a="\0OPEN"+Math.random()+"\0",s="\0CLOSE"+Math.random()+"\0",u="\0COMMA"+Math.random()+"\0",c="\0PERIOD"+Math.random()+"\0";function l(e){return parseInt(e,10)==e?parseInt(e,10):e.charCodeAt(0)}function h(e){return e.split(o).join("\\").split(a).join("{").split(s).join("}").split(u).join(",").split(c).join(".")}function f(e){return"{"+e+"}"}function p(e){return/^-?0\d/.test(e)}function d(e,t){return e<=t}function g(e,t){return e>=t}},function(e,t){e.exports=function(e,t){for(var n=[],i=0;i<e.length;i++){var o=t(e[i],i);r(o)?n.push.apply(n,o):n.push(o)}return n};var r=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";function n(e,t,r){e instanceof RegExp&&(e=i(e,r)),t instanceof RegExp&&(t=i(t,r));var n=o(e,t,r);return n&&{start:n[0],end:n[1],pre:r.slice(0,n[0]),body:r.slice(n[0]+e.length,n[1]),post:r.slice(n[1]+t.length)}}function i(e,t){var r=t.match(e);return r?r[0]:null}function o(e,t,r){var n,i,o,a,s,u=r.indexOf(e),c=r.indexOf(t,u+1),l=u;if(u>=0&&c>0){for(n=[],o=r.length;l>=0&&!s;)l==u?(n.push(l),u=r.indexOf(e,l+1)):1==n.length?s=[n.pop(),c]:((i=n.pop())<o&&(o=i,a=c),c=r.indexOf(t,l+1)),l=u<c&&u>=0?u:c;n.length&&(s=[o,a])}return s}e.exports=n,n.range=o},function(e,t,r){"use strict";r.r(t);var n=r(16),i=r.n(n),o=r(17),a=r.n(o),s=r(18),u=r.n(s),c=r(19),l=r.n(c),h=r(10),f=r.n(h),p=r(20),d=r.n(p),g=r(21),y=r.n(g),m=r(22),b=r.n(m),v=r(0),w=r(6),k=r(7),O=r(11);function j(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){P(e,t,r[t])})}return e}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class S extends w.API{constructor(e){super(e),this.api_root=e.api_root,this.tokenPromise=e.tokenPromise,this.commitAuthor=e.commitAuthor,this.repoURL=""}hasWriteAccess(){return this.getBranch().then(()=>!0).catch(e=>{if(401===e.status){if("Bad credentials"===e.message)throw new v.APIError("Git Gateway Error: Please ask your site administrator to reissue the Git Gateway token.",e.status,"Git Gateway");return!1}throw 404!==e.status||void 0!==e.message&&"Unable to locate site configuration"!==e.message?(console.error("Problem fetching repo data from Git Gateway"),e):new v.APIError("Git Gateway Error: Please make sure Git Gateway is enabled on your site.",e.status,"Git Gateway")})}getRequestHeaders(e={}){return this.tokenPromise().then(t=>{return j({Authorization:`Bearer ${t}`,"Content-Type":"application/json"},e)})}urlFor(e,t){const r=[`ts=${(new Date).getTime()}`];if(t.params)for(const e in t.params)r.push(`${e}=${encodeURIComponent(t.params[e])}`);return r.length&&(e+=`?${r.join("&")}`),this.api_root+e}user(){return Promise.resolve(this.commitAuthor)}request(e,t={}){const r=this.urlFor(e,t);let n;return this.getRequestHeaders(t.headers||{}).then(e=>fetch(r,j({},t,{headers:e}))).then(e=>{n=e.status;const t=e.headers.get("Content-Type");if(t&&t.match(/json/))return this.parseJsonResponse(e);const r=e.text();return e.ok?r:Promise.reject(r)}).catch(e=>{throw new v.APIError(e.message||e.msg,n,"Git Gateway")})}commit(e,t){const r={message:e,tree:t.sha,parents:t.parentSha?[t.parentSha]:[]};return this.commitAuthor&&(r.author=j({},this.commitAuthor,{date:(new Date).toISOString()})),this.request("/git/commits",{method:"POST",body:JSON.stringify(r)})}}var _=r(24),E=r.n(_);function x(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}class T extends k.API{constructor(e){super(e),x(this,"authenticateRequest",async e=>v.unsentRequest.withHeaders({Authorization:`Bearer ${await this.tokenPromise()}`},e)),x(this,"request",async e=>E()([this.buildRequest,this.authenticateRequest,Object(v.then)(v.unsentRequest.performRequest)])(e)),x(this,"hasWriteAccess",()=>Promise.resolve(!0)),this.tokenPromise=e.tokenPromise,this.commitAuthor=e.commitAuthor,this.repoURL=""}}var I=r(12),A=r.n(I),R=r(8),q=r.n(R),U=r(23),L=r.n(U),C=r(1),M=r.n(C),$=r(5),z=r.n($),G=r(2);function D(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const N=z()("button",{label:"LoginButton",target:"ey01qwa0"})(G.buttons.button,";",G.shadows.dropDeep,";",G.buttons.default,";",G.buttons.gray,";padding:0 30px;display:block;margin-top:20px;margin-left:auto;"),H=z()("form",{label:"AuthForm",target:"ey01qwa1"})("width:350px;margin-top:-80px;"),B=z()("input",{label:"AuthInput",target:"ey01qwa2"})("background-color:",G.colorsRaw.white,";border-radius:",G.lengths.borderRadius,";font-size:14px;padding:10px 10px;margin-bottom:15px;margin-top:6px;width:100%;position:relative;z-index:1;&:focus{outline:none;box-shadow:inset 0 0 0 2px ",G.colors.active,";}"),J=z()("p",{label:"ErrorMessage",target:"ey01qwa3"})("color:",G.colors.errorText,";");let F=null;window.netlifyIdentity&&(window.netlifyIdentity.on("login",e=>{F&&F.handleIdentityLogin(e)}),window.netlifyIdentity.on("logout",()=>{F&&F.handleIdentityLogout()}));class W extends M.a.Component{constructor(e){super(e),D(this,"handleIdentityLogin",e=>{this.props.onLogin(e),window.netlifyIdentity.close()}),D(this,"handleIdentityLogout",()=>{window.netlifyIdentity.open()}),D(this,"handleIdentity",()=>{const e=window.netlifyIdentity.currentUser();e?this.props.onLogin(e):window.netlifyIdentity.open()}),D(this,"state",{email:"",password:"",errors:{}}),D(this,"handleChange",(e,t)=>{this.setState(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){D(e,t,r[t])})}return e}({},this.state,{[e]:t.target.value}))}),D(this,"handleLogin",e=>{e.preventDefault();const t=this.state,r=t.email,n=t.password,i={};r||(i.email="Make sure to enter your email."),n||(i.password="Please enter your password."),Object.keys(i).length>0?this.setState({errors:i}):W.authClient.login(this.state.email,this.state.password,!0).then(e=>{this.props.onLogin(e)}).catch(e=>{this.setState({errors:{server:e.description||e.msg||e},loggingIn:!1})})}),F=this}componentDidMount(){!this.loggedIn&&window.netlifyIdentity&&window.netlifyIdentity.currentUser()&&(this.props.onLogin(window.netlifyIdentity.currentUser()),window.netlifyIdentity.close())}componentWillUnmount(){F=null}render(){const e=this.state.errors,t=this.props,r=t.error,n=t.inProgress,i=t.config;return window.netlifyIdentity?M.a.createElement(G.AuthenticationPage,{logoUrl:i.get("logo_url"),onLogin:this.handleIdentity,renderButtonContent:()=>"Login with Netlify Identity"}):M.a.createElement(G.AuthenticationPage,{logoUrl:i.get("logo_url"),renderPageContent:()=>M.a.createElement(H,{onSubmit:this.handleLogin},r?M.a.createElement(J,null,r):null,e.server?M.a.createElement(J,null,e.server):null,M.a.createElement(J,null,e.email||null),M.a.createElement(B,{type:"text",name:"email",placeholder:"Email",value:this.state.email,onChange:A()(this.handleChange,"email")}),M.a.createElement(J,null,e.password||null),M.a.createElement(B,{type:"password",name:"password",placeholder:"Password",value:this.state.password,onChange:A()(this.handleChange,"password")}),M.a.createElement(N,{disabled:n},n?"Logging in...":"Login"))})}}D(W,"propTypes",{onLogin:q.a.func.isRequired,inProgress:q.a.bool.isRequired,error:q.a.node,config:L.a.map});var X=r(3),Y=r.n(X),Z=r(9),Q=r.n(Z),V=r(4),K=r.n(V),ee=r(13),te=r.n(ee),re=r(25),ne=r.n(re);function ie(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function oe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){ae(e,t,r[t])})}return e}function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}const ue=e=>e.split("\n"),ce=e=>e.split(/\s+/g),le=K()([Y()(e=>e.trim()),te()(e=>""!==e)]),he=K()([ue,le,Y()(ce),Q.a,e=>{let t=e.size,r=e.oid,n=se(e,["size","oid"]);return oe({size:parseInt(t),sha:r.split(":")[1]},n)}]),fe=({size:e,sha:t})=>`version https://git-lfs.github.com/spec/v1\noid sha256:${t}\nsize ${e}\n`,pe=K()([Y()(e=>e.includes("=")?e.split("="):e.startsWith("-")?[e.slice(1),!1]:[e,!0]),Q.a]),de=K()([ce,([e,...t])=>[e,pe(t)]]),ge=K()([ue,Y()(e=>e.split("#")[0]),le,Y()(de)]),ye=K()([ge,te()(([e,t])=>"lfs"===t.filter&&"lfs"===t.diff&&"lfs"===t.merge),Y()(([e])=>e)]),me={Accept:"application/vnd.git-lfs+json","Content-Type":"application/vnd.git-lfs+json"},be=async({rootURL:e,makeAuthorizedRequest:t},{sha:r,size:n})=>{const i=await t({url:`${e}/verify`,method:"POST",headers:me,body:JSON.stringify({oid:r,size:n})});return!!i.ok||404!==i.status&&void 0},ve=(e,t)=>Promise.resolve(t.map(({sha:t})=>[t,(({rootURL:e,makeAuthorizedRequest:t,transformImages:r},n)=>()=>t(`${e}/origin/${n}${r&&Object.keys(r).length>0?`?nf_resize=${r.nf_resize}&w=${r.w}&h=${r.h}`:""}`).then(e=>e.ok?e:Promise.reject(e)).then(e=>e.blob()).then(e=>URL.createObjectURL(e)).catch(e=>console.error(e)||Promise.resolve("")))(e,t)])),we=async({rootURL:e,makeAuthorizedRequest:t},r)=>{const n=await t({url:`${e}/objects/batch`,method:"POST",headers:me,body:JSON.stringify((e=>({operation:"upload",transfers:["basic"],objects:e.map(e=>{let t=e.sha;return oe({},se(e,["sha"]),{oid:t})})}))(r))});return(await n.json()).objects.map(e=>{if(e.error)throw new Error(e.error.message);return e.actions.upload.href})},ke={resourceExists:be,getResourceUploadURLs:we,getResourceDownloadURLs:(e,t)=>ve(e,t).then(Y()(([e,t])=>Promise.all([e,t()]))).then(Promise.all.bind(Promise)),getResourceDownloadURLThunks:ve,uploadResource:async(e,{sha:t,size:r},n)=>{if(await be(e,{sha:t,size:r}))return t;const i=ie(await we(e,[{sha:t,size:r}]),1)[0];return await((e,t,r)=>fetch(t,{method:"PUT",body:r}))(0,i,n),t},matchPath:({patterns:e},t)=>e.some(e=>ne()(t,e,{matchBase:!0}))},Oe=e=>K()([Object.keys,Y()(t=>[t,((e,t)=>(...r)=>t(e,...r))(e,ke[t])]),Q.a,t=>oe({},t,{patterns:e.patterns,enabled:e.enabled})])(ke);function je(e,t){if(null==e)return{};var r,n,i=function(e,t){if(null==e)return{};var r,n,i={},o=Object.keys(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||(i[r]=e[r]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)r=o[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(i[r]=e[r])}return i}function Pe(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable}))),n.forEach(function(t){Se(e,t,r[t])})}return e}function Se(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const _e={localhost:!0,"127.0.0.1":!0,"0.0.0.0":!0},Ee={identity:"/.netlify/identity",gateway:"/.netlify/git",largeMedia:"/.netlify/large-media"};function xe(e,t){if(_e[document.location.host.split(":").shift()]&&t&&e.match(/^\/\.netlify\//)){const r=[];return t&&(r.push(t),t.match(/\/$/)||r.push("/")),r.push(e.replace(/^\//,"")),r.join("")}return e}class Te{constructor(e,t={}){Se(this,"requestFunction",e=>this.tokenPromise().then(t=>v.unsentRequest.withHeaders({Authorization:`Bearer ${t}`},e)).then(v.unsentRequest.performRequest)),this.options=Pe({proxied:!0,API:null},t),this.config=e,this.branch=e.getIn(["backend","branch"],"master").trim(),this.squash_merges=e.getIn(["backend","squash_merges"]);const r=localStorage.getItem("netlifySiteURL"),n=xe(e.getIn(["backend","identity_url"],Ee.identity),r);this.gatewayUrl=xe(e.getIn(["backend","gateway_url"],Ee.gateway),r),this.netlifyLargeMediaURL=xe(e.getIn(["backend","large_media_url"],Ee.largeMedia),r);const i=/\/(github|gitlab|bitbucket)\/?$/,o=this.gatewayUrl.match(i);o?(this.backendType=o[1],this.gatewayUrl=this.gatewayUrl.replace(i,"")):this.backendType=null,this.authClient=window.netlifyIdentity?window.netlifyIdentity.gotrue:new d.a({APIUrl:n}),W.authClient=this.authClient,this.backend=null}authenticate(e){return this.tokenPromise=e.jwt.bind(e),this.tokenPromise().then(async t=>{if(!this.backendType){const e=await fetch(`${this.gatewayUrl}/settings`,{headers:{Authorization:`Bearer ${t}`}}).then(async e=>{const t=e.headers.get("Content-Type");if(!t.includes("application/json")&&!t.includes("text/json"))throw new v.APIError("Your Git Gateway backend is not returning valid settings. Please make sure it is enabled.",e.status,"Git Gateway");const r=await e.json();if(!e.ok)throw new v.APIError(`Git Gateway Error: ${r.message?r.message:r}`,e.status,"Git Gateway");return r}),r=e.github_enabled,n=e.gitlab_enabled,i=e.bitbucket_enabled,o=e.roles;this.acceptRoles=o,r?this.backendType="github":n?this.backendType="gitlab":i&&(this.backendType="bitbucket")}if(this.acceptRoles&&this.acceptRoles.length>0){const e=l()(y()(t),"app_metadata.roles",[]);if(!(a()(e,this.acceptRoles).length>0))throw new Error("You don't have sufficient permissions to access Netlify CMS")}const r={name:e.user_metadata.full_name||e.email.split("@").shift(),email:e.email,avatar_url:e.user_metadata.avatar_url,metadata:e.user_metadata},n={api_root:`${this.gatewayUrl}/${this.backendType}`,branch:this.branch,tokenPromise:this.tokenPromise,commitAuthor:u()(r,["name","email"]),squash_merges:this.squash_merges,initialWorkflowStatus:this.options.initialWorkflowStatus};if("github"===this.backendType?(this.api=new S(n),this.backend=new w.GitHubBackend(this.config,Pe({},this.options,{API:this.api}))):"gitlab"===this.backendType?(this.api=new T(n),this.backend=new k.GitLabBackend(this.config,Pe({},this.options,{API:this.api}))):"bitbucket"===this.backendType&&(this.api=new O.API(Pe({},n,{requestFunction:this.requestFunction,hasWriteAccess:async()=>!0})),this.backend=new O.BitBucketBackend(this.config,Pe({},this.options,{API:this.api}))),!await this.api.hasWriteAccess())throw new Error("You don't have sufficient permissions to access Netlify CMS")})}restoreUser(){const e=this.authClient&&this.authClient.currentUser();return e?this.authenticate(e):Promise.reject()}authComponent(){return W}logout(){if(window.netlifyIdentity)return window.netlifyIdentity.logout();const e=this.authClient.currentUser();return e&&e.logout()}getToken(){return this.tokenPromise()}entriesByFolder(e,t){return this.backend.entriesByFolder(e,t)}entriesByFiles(e){return this.backend.entriesByFiles(e)}fetchFiles(e){return this.backend.fetchFiles(e)}getEntry(e,t,r){return this.backend.getEntry(e,t,r)}getMedia(){return Promise.all([this.backend.getMedia(),this.getLargeMediaClient()]).then(async([e,t])=>{if(!t.enabled)return e;const r=await this.getLargeMedia(e);return e.map(e=>{let t=e.id,n=e.url,i=e.urlIsPublicPath,o=e.getDisplayURL;return Pe({},je(e,["id","url","urlIsPublicPath","getDisplayURL"]),{id:t,url:n,urlIsPublicPath:!r[t]&&i,getDisplayURL:r[t]?r[t]:o||n&&(()=>Promise.resolve(n))})})})}getLargeMediaClient(){return this._largeMediaClientPromise?this._largeMediaClientPromise:(this._largeMediaClientPromise=this._getLargeMediaClient(),this._largeMediaClientPromise)}_getLargeMediaClient(){const e=this.api.readFile(".lfsconfig").then(b.a.decode).then(({lfs:{url:e}})=>new URL(e)).then(e=>({enabled:e.hostname.endsWith("netlify.com")})).catch(e=>({enabled:!1,err:e})),t=this.api.readFile(".gitattributes").then(ye).then(e=>({patterns:e})).catch(e=>e.message.includes("404")?[]:{err:e});return Promise.all([e,t]).then(([{enabled:e},{patterns:t,err:r}])=>{const n=e&&!r;return e&&r&&console.error(r),Oe({enabled:n,rootURL:this.netlifyLargeMediaURL,makeAuthorizedRequest:this.requestFunction,patterns:t,transformImages:!!this.config.getIn(["backend","use_large_media_transforms_in_media_library"],!0)&&{nf_resize:"fit",w:280,h:160}})})}getLargeMedia(e){return this.getLargeMediaClient().then(t=>{const r=e.filter(({path:e})=>t.matchPath(e)).map(({id:e,path:t})=>({path:t,sha:e}));return this.backend.fetchFiles(r).then(e=>e.map(({file:{sha:e},data:t})=>{const r=he(t);return[{pointerId:e,resourceId:r.sha},r]})).then(i.a).then(async([e,r])=>[e,await t.getResourceDownloadURLThunks(r).then(f.a)]).then(([e,t])=>e.map(({pointerId:e,resourceId:r})=>[e,t[r]])).then(f.a)})}persistEntry(e,t,r){return this.backend.persistEntry(e,t,r)}persistMedia(e,t){const r=e.fileObj,n=e.path,i=e.value,o=r.name,a=r.size;return this.getLargeMediaClient().then(s=>{const u=n.startsWith("/")?n.slice(1):n;return s.enabled&&s.matchPath(u)?Object(v.getBlobSHA)(r).then(async e=>{await s.uploadResource({sha:e,size:a},r);const u=fe({sha:e,size:a}),c=new Blob([u]),l=new File([c],o,{type:"text/plain"}),h=await Object(v.getBlobSHA)(l),f={fileObj:l,size:c.size,path:n,sha:h,raw:u,value:i};return Pe({},await this.backend.persistMedia(f,t),{urlIsPublicPath:!1})}):this.backend.persistMedia(e,t)})}deleteFile(e,t,r){return this.backend.deleteFile(e,t,r)}getDeployPreview(e,t){if(this.backend.getDeployPreview)return this.backend.getDeployPreview(e,t)}unpublishedEntries(){return this.backend.unpublishedEntries()}unpublishedEntry(e,t){return this.backend.unpublishedEntry(e,t)}updateUnpublishedEntryStatus(e,t,r){return this.backend.updateUnpublishedEntryStatus(e,t,r)}deleteUnpublishedEntry(e,t){return this.backend.deleteUnpublishedEntry(e,t)}publishUnpublishedEntry(e,t){return this.backend.publishUnpublishedEntry(e,t)}traverseCursor(e,t){return this.backend.traverseCursor(e,t)}}r.d(t,"GitGatewayBackend",function(){return Te}),r.d(t,"AuthenticationPage",function(){return W})}])});
//# sourceMappingURL=netlify-cms-backend-git-gateway.js.map